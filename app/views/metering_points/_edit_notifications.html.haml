.modal-content
  .modal-header
    %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", type: "button"} Ã—
    %h4.modal-title= t'edit_notifications'

  .modal-body
    %p
      = t('these_settings_are_just_valid_for_this_metering_point')
      = t('to_change_your_global_notification_settings_please_visit_your_profile', your_profile: link_to(t('your_profile'), profile_path(current_user.profile))).html_safe
    = simple_form_for @metering_point, remote: true, url: edit_notifications_update_metering_point_path, method: 'put' do |f|
      - overridden = current_user.notification_unsubscribers.by_resource(nil).by_key('comment.create').any? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('comment.create').empty? || current_user.notification_unsubscribers.by_resource(nil).by_key('comment.create').empty? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('comment.create').any?
      = f.input :notify_me_when_comment_create, as: :radio_buttons, checked: current_user.notification_unsubscribers.by_resource(@metering_point).by_key('comment.create').any? ? 'false' : 'true', hint: overridden ? t('this_setting_is_overridden_by_your_global_settings_so_you_have_to_change_these_first') : nil
      - overridden = current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.exceeds').any? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.exceeds').empty? || current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.exceeds').empty? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.exceeds').any?
      = f.input :notify_me_when_metering_point_exceeds, as: :radio_buttons, checked: current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.exceeds').any? ? 'false' : 'true', hint: overridden ? t('this_setting_is_overridden_by_your_global_settings_so_you_have_to_change_these_first') : nil
      - overridden = current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.undershoots').any? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.undershoots').empty? || current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.undershoots').empty? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.undershoots').any?
      = f.input :notify_me_when_metering_point_undershoots, as: :radio_buttons, checked: current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.undershoots').any? ? 'false' : 'true', hint: overridden ? t('this_setting_is_overridden_by_your_global_settings_so_you_have_to_change_these_first') : nil
      - overridden = current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.offline').any? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.offline').empty? || current_user.notification_unsubscribers.by_resource(nil).by_key('metering_point.offline').empty? && current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.offline').any?
      = f.input :notify_me_when_metering_point_offline, as: :radio_buttons, checked: current_user.notification_unsubscribers.by_resource(@metering_point).by_key('metering_point.offline').any? ? 'false' : 'true', hint: overridden ? t('this_setting_is_overridden_by_your_global_settings_so_you_have_to_change_these_first') : nil
      .modal-footer
        .btn.btn-primary.btn-labeled.fa.fa-remove{"data-dismiss" => "modal"}
          = t'cancel'
        = f.button :button, t('save'), id: 'submit', class: 'btn btn-success btn-labeled fa fa-check'