- meta title: @metering_point.name

= content_for :aside do
  %aside#aside-container
    #aside
      .nano
        .nano-content{:tabindex => "0"}
          .text-center.pad-all
            .pad-ver
              %span.fa-stack.fa-lg.fa-5x
                %i.fa.fa-circle.fa-stack-2x
                %i.fa.fa-bolt.fa-stack-1x.fa-inverse
            %h4.text-lg.text-overflow.mar-no= @metering_point.name


          - if @metering_point.address
            %hr
            .pad-hor
              %h5=t('address')
              %address
                = "#{@metering_point.address.street_name} #{@metering_point.address.street_number}"
                %br
                = "#{@metering_point.address.zip} #{@metering_point.address.city}"
                %br
                = @metering_point.address.state

          - if @meter
            %hr
              %ul.list-group.bg-trans
                %li.list-group-item.list-item-sm
                  %i.fa.fa-tachometer.fa-fw
                  = link_to @meter.name, @meter

          %hr
            .text-center.clearfix
              .col-xs-6
                %p.h3= @users.count
                %small.text-muted= t'residents'
              .col-xs-6
                %p.h3= @devices.count
                %small.text-muted= t'devices'
          %hr
            .text-center.clearfix
              - if current_user.can_update?(@metering_point)
                = @metering_point.link_to_edit




#page-content

  - if @metering_point.path_ids.count > 1
    .pad-ver
      %ol.breadcrumb
        - @metering_point.path_ids.each do |metering_point_id|
          - @metering_point = MeteringPoint.find(metering_point_id).decorate
          %li= link_to @metering_point.name, @metering_point

  .row
    = render @metering_point.registers

  .row
    .col-sm-12.col-md-12.col-lg-12.metering_point_detail{id: "metering_point_#{@metering_point.id}"}
      .panel.cover{:style => "background-image: url(#{@metering_point.smart_image ? @metering_point.smart_image.cover : '//placehold.it/1000x400&text=no_image_found'})"}
        .chart{id: "chart-container-#{@metering_point.id}", style: "width: 100%; height: 300px;"}





  %h1.page-header.text-overflow= t'devices' if current_user.can_update?(@metering_point) || @devices.size != 0
  .row
    .devices
      = render @devices

    - if current_user.can_update?(@metering_point)
      .row
        .col-lg-12.text-center
          = @metering_point.edit_devices
    %hr





  %h1.page-header.text-overflow= t'residents' if current_user.can_update?(@metering_point) || @users.size != 0
  .row
    - @users.each do |user|
      = render user.profile

    - if current_user.can_update?(@metering_point)
      .row
        .col-lg-12.text-center
          = @metering_point.edit_users
    %hr




  - if current_user.can_update?(@metering_point)
    %h1.page-header.text-overflow= t'meters'
    .row
      .meters
        = render @metering_point.meter if @metering_point.meter

    - if @metering_point.meter.nil?
      .row
        .col-lg-12.text-center
          = @metering_point.new_meter
    %hr




    %h1.page-header.text-overflow= t'contracts'
    .row
      .contracts
        = render @metering_point.contracts

    - if current_user.can_update?(@metering_point)
      .row
        .col-lg-12.text-center
          = @metering_point.new_contract
    %hr



  %h1.page-header.text-overflow= t'sub_metering_points' if current_user.can_update?(@metering_point) || @metering_point.children.size != 0
  .row
    .metering_points
      - @metering_point.children.each do |sub_metering_point|
        = render sub_metering_point.decorate

    - if current_user.can_update?(@metering_point)
      .row
        .col-lg-12.text-center
          = @metering_point.new_sub_metering_point
    %hr



